function sack(file){this.AjaxFailedAlert="Trình duyệt của bạn không hỗ trợ Load Ajax. Bạn nên chọn một trình duyệt khác để sử dụng được tất cả chức năng của hệ thống.\n",this.requestFile=file,this.method="POST",this.URLString="",this.encodeURIString=!0,this.execute=!1,this.onLoading=function(){},this.onLoaded=function(){},this.onInteractive=function(){},this.onCompletion=function(){},this.createAJAX=function(){try{this.xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{this.xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){this.xmlhttp=null}}this.xmlhttp||"undefined"==typeof XMLHttpRequest||(this.xmlhttp=new XMLHttpRequest),this.xmlhttp||(this.failed=!0)},this.setVar=function(a,b){this.URLString.length<3?this.URLString=a+"="+b:this.URLString+="&"+a+"="+b},this.encVar=function(a,b){return encodeURIComponent(a)+"="+encodeURIComponent(b)},this.encodeURLString=function(a){for(varArray=a.split("&"),i=0;i<varArray.length;i++)urlVars=varArray[i].split("="),-1!=urlVars[0].indexOf("amp;")&&(urlVars[0]=urlVars[0].substring(4)),varArray[i]=this.encVar(urlVars[0],urlVars[1]);return varArray.join("&")},this.runResponse=function(){eval(this.response)},this.runAJAX=function(a){if(this.responseStatus=new Array(2),this.failed&&this.AjaxFailedAlert)alert(this.AjaxFailedAlert);else{if(a&&(this.URLString.length?this.URLString=this.URLString+"&"+a:this.URLString=a),this.encodeURIString){var b=(new Date).getTime();this.URLString=this.encodeURLString(this.URLString),this.setVar("rndval",b)}if(this.element&&(this.elementObj=document.getElementById(this.element)),this.xmlhttp){var c=this;if("GET"==this.method){var d=this.requestFile+"?"+this.URLString;this.xmlhttp.open(this.method,d,!0)}else this.xmlhttp.open(this.method,this.requestFile,!0);if("POST"==this.method)try{this.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(a){}this.xmlhttp.send(this.URLString),this.xmlhttp.onreadystatechange=function(){switch(c.xmlhttp.readyState){case 1:c.onLoading();break;case 2:c.onLoaded();break;case 3:c.onInteractive();break;case 4:if(c.response=c.xmlhttp.responseText,c.responseXML=c.xmlhttp.responseXML,c.responseStatus[0]=c.xmlhttp.status,c.responseStatus[1]=c.xmlhttp.statusText,c.onCompletion(),c.execute&&c.runResponse(),c.elementObj){var a=c.elementObj.nodeName;a.toLowerCase(),"input"==a||"select"==a||"option"==a||"textarea"==a?c.elementObj.value=c.response:c.elementObj.innerHTML=c.response}c.URLString=""}}}}},this.createAJAX()}